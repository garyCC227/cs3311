<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0063)https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>COMP3311 19s1 - Exercises 07</title>
<link rel="stylesheet" type="text/css" href="./19s1 - Exercises 07_files/course.css"><script language="JavaScript">
function changeText(el, newText) {
  // Safari work around
  if (el.innerText)
    el.innerText = newText;
  else if (el.firstChild && el.firstChild.nodeValue)
    el.firstChild.nodeValue = newText;
}
function toggleVisible(elid) {
  el1 = document.getElementById(elid);
  el2 = document.getElementById(elid+"a");
  if (el1.style.display == "") {
     el1.style.display = "none";
     changeText(el2,"show answer");
  }
  else {
     el1.style.display = "";
     changeText(el2,"hide answer");
  }
}
</script><script>(async()=> {const internalUrls = {"zanshang":"chrome-extension://bfcbfobhcjbkilcbehlnlchiinokiijp/zanshang.png"};const manifest = {"background":{"scripts":["lib.js","bg.js"]},"browser_action":{"default_popup":"popup.html","default_title":"B站下载助手"},"content_scripts":[{"all_frames":true,"js":["lib.js"],"matches":["http://*/*","https://*/*"]},{"all_frames":false,"js":["cs.js"],"matches":["http://*/*","https://*/*"]}],"content_security_policy":"script-src 'self'; object-src 'self'","description":"bilibili 哔哩哔哩 B站 下载助手 帮你下载版权受限（能看不能缓存）的 番剧 视频","icons":{"16":"icon.png","48":"icon.png","128":"icon.png"},"key":"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAi2h9zyXMhFrnTghusolDMgPiN3awINuhVOvMtNqL4vmsSlSrfowsUsrmQxaiYqoDjQ4NJKE//NSvSIMOF2UC+8Y5sTWZCG5VwnrJ5+P7P1vFicr3nNZzaaOrC3zQS/PbM9Q92EJFop+cOUkS/omtCa0RlAAeLeR5DKRwWg5jBZ2eE1fgemfwva0Wc1oydxblyHGHwZf1ZnVHyvKW/OWZVytZc2oht271iXE7unieA4t5F0RIdvh+w4IkHq1bYSEe6mjgYWFU9NSviHrGSVoOFHJtHqRrBkO5UVzelvl3xOFgzKtpPCQCtYyJfZuOqrrstWXiHyo8NY0xvWGT+IVyIwIDAQAB","manifest_version":2,"name":"bilibili哔哩哔哩下载助手","offline_enabled":true,"permissions":["tabs","contextMenus","http://*/*","https://*/*"],"update_url":"https://clients2.google.com/service/update2/crx","version":"2.0.9","web_accessible_resources":["*.*","**/*.*"]};const e=()=>"www.bilibili.com"===location.hostname||"bilibili.com"===location.hostname;if(!e())return;const t=()=>/\/video\/av\d+/i.test(window.location.pathname),n=()=>/\/bangumi\/play\/\S+/i.test(window.location.pathname);if(!t()&&!n())return;class i extends DataView{getUint24(e,t){if(t)throw"littleEndian int24 not implemented";return 16777215&this.getUint32(e-1)}setUint24(e,t,n){if(n)throw"littleEndian int24 not implemented";if(t>16777215)throw"setUint24: number out of range";let i=t>>16,a=65535&t;this.setUint8(e,i),this.setUint16(e+1,a)}indexOf(e,t=0,n=this.byteLength-e.length+1){if(e.charCodeAt){for(let i=t;i<n;i++){if(this.getUint8(i)!=e.charCodeAt(0))continue;let t=1;for(let n=0;n<e.length;n++)if(this.getUint8(i+n)!=e.charCodeAt(n)){t=0;break}if(t)return i}return-1}for(let i=t;i<n;i++){if(this.getUint8(i)!=e[0])continue;let t=1;for(let n=0;n<e.length;n++)if(this.getUint8(i+n)!=e[n]){t=0;break}if(t)return i}return-1}}class a{constructor(e,t=0){this.tagHeader=new i(e.buffer,e.byteOffset+t,11),this.tagData=new i(e.buffer,e.byteOffset+t+11,this.dataSize),this.previousSize=new i(e.buffer,e.byteOffset+t+11+this.dataSize,4)}get tagType(){return this.tagHeader.getUint8(0)}get dataSize(){return this.tagHeader.getUint24(1)}get timestamp(){return this.tagHeader.getUint24(4)}get timestampExtension(){return this.tagHeader.getUint8(7)}get streamID(){return this.tagHeader.getUint24(8)}stripKeyframesScriptData(){let e;if(18!=this.tagType)throw"can not strip non-scriptdata's keyframes";-1!=(e=this.tagData.indexOf("hasKeyframes"))&&this.tagData.setUint8(e+"hasKeyframes".length,0)}getDuration(){if(18!=this.tagType)throw"can not find non-scriptdata's duration";let e=this.tagData.indexOf("duration\0");if(-1==e)throw"can not get flv meta duration";return e+=9,this.tagData.getFloat64(e)}getDurationAndView(){if(18!=this.tagType)throw"can not find non-scriptdata's duration";let e=this.tagData.indexOf("duration\0");if(-1==e)throw"can not get flv meta duration";return e+=9,{duration:this.tagData.getFloat64(e),durationDataView:new i(this.tagData.buffer,this.tagData.byteOffset+e,8)}}getCombinedTimestamp(){return this.timestampExtension<<24|this.timestamp}setCombinedTimestamp(e){if(e<0)throw"timestamp < 0";this.tagHeader.setUint8(7,e>>24),this.tagHeader.setUint24(4,16777215&e)}}class o{constructor(e){if(0!=e.indexOf("FLV",0,1))throw"Invalid FLV header";this.header=new i(e.buffer,e.byteOffset,9),this.firstPreviousTagSize=new i(e.buffer,e.byteOffset+9,4),this.tags=[];let t=this.headerLength+4;for(;t<e.byteLength;){let n=new a(e,t);t+=11+n.dataSize+4,this.tags.push(n)}if(t!=e.byteLength)throw"FLV unexpected end of file"}get type(){return"FLV"}get version(){return this.header.getUint8(3)}get typeFlag(){return this.header.getUint8(4)}get headerLength(){return this.header.getUint32(5)}static merge(e){if(e.length<1)throw"Usage: FLV.merge([flvs])";let t,n=[],i=[0,0],a=[0,0],o=0;n.push(e[0].header),n.push(e[0].firstPreviousTagSize);for(let s of e){let r=1e3*o;i[0]=a[0],i[1]=a[1],r=Math.max(r,i[0],i[1]);let l=0;for(let i of s.tags)18!=i.tagType||l?8!=i.tagType&&9!=i.tagType||(a[i.tagType-8]=r+i.getCombinedTimestamp(),i.setCombinedTimestamp(a[i.tagType-8]),n.push(i.tagHeader),n.push(i.tagData),n.push(i.previousSize)):(o+=i.getDuration(),l=1,s==e[0]&&(({duration:o,durationDataView:t}=i.getDurationAndView()),i.stripKeyframesScriptData(),n.push(i.tagHeader),n.push(i.tagData),n.push(i.previousSize)))}return t.setFloat64(0,o),new Blob(n)}static async mergeBlobs(e){if(e.length<1)throw"Usage: FLV.mergeBlobs([blobs])";let t,n=[],a=[0,0],s=[0,0],r=0;for(let l of e){let d=1e3*r;a[0]=s[0],a[1]=s[1],d=Math.max(d,a[0],a[1]);let c=0,g=await new Promise((e,t)=>{let n=new FileReader;n.onload=(()=>e(new o(new i(n.result)))),n.readAsArrayBuffer(l),n.onerror=t}),p=[];for(let i of g.tags)18!=i.tagType||c?8!=i.tagType&&9!=i.tagType||(s[i.tagType-8]=d+i.getCombinedTimestamp(),i.setCombinedTimestamp(s[i.tagType-8]),p.push(i.tagHeader,i.tagData,i.previousSize)):(r+=i.getDuration(),c=1,l==e[0]&&(n.push(g.header,g.firstPreviousTagSize),({duration:r,durationDataView:t}=i.getDurationAndView()),i.stripKeyframesScriptData(),n.push(i.tagHeader),n.push(i.tagData),n.push(i.previousSize)));n.push(new Blob(p))}return t.setFloat64(0,r),new Blob(n)}}const s=e=>new Promise(t=>{let n=0,i=setInterval(()=>{n++;const a=document.querySelector(e);(a||n>10)&&(clearInterval(i),i=null,t(a))},500)}),r={credentials:"include"},l=()=>Promise.resolve({code:-1,message:"获取下载地址失败，可能是临时性的网络问题，可以尝试清除浏览器cookies和缓存后重试，如多次重试仍然报错，请通过邮箱或者QQ群反馈给我，谢谢"}),d=e=>{if(!e.durl)return-10403===e.code?(e.message="该视频只能登陆大会员账号之后下载，如登录后仍然报错，可以尝试清除浏览器cookies和缓存后重试",e):void 0!==e.code?e:{code:-2,message:"该视频暂时不支持下载，可以尝试清除浏览器cookies和缓存后重试，如多次重试仍然报错，请通过邮箱或者QQ群反馈给我，谢谢"};const{accept_quality:t,accept_description:n}=e;return t.forEach((e,t)=>{c[e]=n[t]}),{code:0,durls:e.durl.map(e=>{const t=new URL(e.url);return t.protocol=window.location.protocol,{url:t.href,size:e.size}}),qualityDescription:c[e.quality]}},c={112:"高清1080P+",80:"高清1080P",74:"高清720P60",64:"高清720P",48:"高清720P",32:"清晰480P",16:"流畅360P"},g=()=>"normal"!==localStorage.bilibili_helper_download_mode,p=()=>"off"!==localStorage.bilibili_helper_merge_mode,h=()=>"hide"===localStorage.bilibili_helper_show,m=e=>{const t=1073741824,n=1048576;return e>=t?`${(e/t).toFixed(2)}GB`:e>=n?`${(e/n).toFixed(2)}MB`:e>=1024?`${(e/1024).toFixed(2)}KB`:e+"B"},u=(e,t,n,i)=>0!==n?`<strong>${i}</strong>`:`<strong>${e}</strong> 的下载地址(共${t.length}个分段)：`,f=(e,t,n,i)=>{if(0!==n)return"";if(!g())return e.map((e,n)=>`\n        <li><a title="${t}_分段${n+1}" download href="${e.url}">分段${n+1}</a><span class="size">(${m(e.size)})</span></li>\n      `).join("");if(g()&&!p())return e.map((e,n)=>{const i=encodeURIComponent(JSON.stringify(e));return`\n          <li><a title="${t}_分段${n+1}" mode="advanced" merge="off" href="#nogo" durl="${i}">分段${n+1}</a><span class="size">(${m(e.size)})</span><span durl="${i}" class="progress"></span></li>\n        `}).join("");if(g()&&p()){const n=encodeURIComponent(JSON.stringify(e));let i=0;return e.forEach(e=>i+=e.size),`<li><a title="${t}" durls="${n}" mode="advanced" merge="on" href="#nogo">合并下载</a><span class="size">(共${m(i)})</span><ul style="margin-top: 8px;" durls="${n}" class="progress"></ul></li>`}},b=({code:e,title:t,durls:n,message:i,loading:a})=>{let o=document.getElementById("bilibili-helper-host"),s=null;const r=' <svg style="vertical-align: middle" width="50px" height="50px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-pacman"><g ng-attr-style="display:{{config.showBean}}" style="display:block"><circle cx="62.0973" cy="50" r="4" ng-attr-fill="{{config.c2}}" fill="#00a1d6"><animate attributeName="cx" calcMode="linear" values="95;35" keyTimes="0;1" dur="1" begin="-0.67s" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" calcMode="linear" values="0;1;1" keyTimes="0;0.2;1" dur="1" begin="-0.67s" repeatCount="indefinite"></animate></circle><circle cx="82.4973" cy="50" r="4" ng-attr-fill="{{config.c2}}" fill="#00a1d6"><animate attributeName="cx" calcMode="linear" values="95;35" keyTimes="0;1" dur="1" begin="-0.33s" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" calcMode="linear" values="0;1;1" keyTimes="0;0.2;1" dur="1" begin="-0.33s" repeatCount="indefinite"></animate></circle><circle cx="42.2973" cy="50" r="4" ng-attr-fill="{{config.c2}}" fill="#00a1d6"><animate attributeName="cx" calcMode="linear" values="95;35" keyTimes="0;1" dur="1" begin="0s" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" calcMode="linear" values="0;1;1" keyTimes="0;0.2;1" dur="1" begin="0s" repeatCount="indefinite"></animate></circle></g><g ng-attr-transform="translate({{config.showBeanOffset}} 0)" transform="translate(-15 0)"><path d="M50 50L20 50A30 30 0 0 0 80 50Z" ng-attr-fill="{{config.c1}}" fill="#f45a8d" transform="rotate(10.946 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;45 50 50;0 50 50" keyTimes="0;0.5;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform></path><path d="M50 50L20 50A30 30 0 0 1 80 50Z" ng-attr-fill="{{config.c1}}" fill="#f45a8d" transform="rotate(-10.946 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;-45 50 50;0 50 50" keyTimes="0;0.5;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform></path></g></svg>';o?((s=o.shadowRoot).getElementById("title").innerHTML=a?"加载中"+r:u(t,n,e,i),s.getElementById("durls").innerHTML=a?"":f(n,t,e)):((o=document.createElement("bilibili-helper-host")).id="bilibili-helper-host",o.style.cssText=`display:block;overflow:auto;position:fixed;z-index:${Number.MAX_SAFE_INTEGER};bottom:0;left:0;right:0;max-height:50%;width:100%;background: #fff;border-top: 1px solid #ccc;box-shadow: rgba(0, 0, 0, 0.2) 0 -5px 10px;`,h()?o.classList.add("hide"):o.classList.remove("hide"),o.innerHTML="<style>\n        #bilibili-helper-host.hide{\n          width:auto!important;\n          left:auto!important;\n          background:transparent!important;\n          border:0 none!important;\n          border-radius: 6px 0 0 0;\n          box-shadow: rgba(0, 0, 0, 0.2) -5px -5px 10px!important;\n        }\n        .player-fullscreen-fix #bilibili-helper-host {\n          z-index: 99999!important;\n        }\n      </style>",document.body.appendChild(o),(s=o.attachShadow({mode:"open"})).innerHTML=`\n        <style>\n          p, a, div, span, li, i, b, strong, input, button, label {\n            font-size: inherit;\n          }\n          li {\n            margin-bottom: 5px;\n          }\n          p {\n            margin: 0;\n            line-height: 1.5;\n          }\n          h1 {\n            font-size: 20px;\n            font-weight: bold;\n            margin-bottom: 20px;\n          }\n          h3 {\n            font-size: 16px;\n            margin: 1em 0;\n          }\n          #title {\n            font-size: 16px;\n            font-weight: normal;\n          }\n          #content {\n            display: flex;\n            width: 100%;\n            font-size: 14px;\n            position: relative;\n          }\n          a {\n            color: #00a1d6 !important;\n            text-decoration: none;\n          }\n          a:hover {\n            text-decoration: underline;\n          }\n          a.disabled {\n            color: #666!important;\n          }\n          a.disabled:hover {\n            text-decoration: none;\n            cursor: not-allowed;\n          }\n          #side-bar {\n            flex: 3;\n            padding: 20px;\n            border-right: 1px solid #ccc;\n            margin-right: -1px;\n          }\n          #main {\n            flex: 7;\n            padding: 20px;\n            border-left: 1px solid #ccc;\n          }\n          #notice-frame {\n            width: 100%;\n            padding: 0;\n          }\n          .donate {\n            border-top: 1px solid #ccc;\n            padding-top: 10px;\n          }\n          #zanshang {\n            width: 80%;\n          }\n          .setting-item {\n            margin-bottom: 8px;\n          }\n          .setting-item .label {\n            font-weight: bold;\n            width: 6em;\n            display: inline-block;\n            text-align: right;\n          }\n          .desc {\n            padding-left: 6em;\n          }\n          #actions {\n            position: absolute;\n            right: 0;\n            top: 0;\n          }\n          .btn-large {\n            border: 0 none;\n            background: #f45a8d;\n            border-radius: 6px;\n            color: #fff;\n            padding: 10px 20px;\n          }\n          #toggle {\n            border-radius: 0 0 0 6px;\n            outline: none;\n            cursor: pointer;\n          }\n          .hide #side-bar {\n            display: none;\n          }\n          .hide #main {\n            display: none;\n          }\n          .hide #toggle {\n            border-radius: 6px 0 0 0;\n          }\n          .hide #actions {\n            position: static;\n          }\n      \n          a.btn {\n            border: 0 none;\n            background: #f45a8d;\n            text-decoration: none !important;\n            color: #fff !important;\n            border-radius: 3px;\n            padding: 5px 10px;\n            display: inline-block;\n          }\n          .settings {\n            border-left: 5px solid #ccc;\n            background: #eee;\n            padding: 16px 16px 8px 0;\n          }\n          .size {\n            margin: 0 5px;\n          }\n        </style>\n        <div id="content" ${h()?'class="hide"':""}>\n          <div id="side-bar">\n            <div class="notice">\n              <iframe id="notice-frame" frameborder="0"></iframe>\n            </div>\n            \x3c!--<div class="support">TODO 支持区域</div>--\x3e\n            <div class="donate">\n              <p>微信扫一扫赞赏作者(扫不出来请点击图片后扫大图)：</p>\n              <a href="${internalUrls.zanshang}" target="_blank"><img title="点击查看大图" alt="点击查看大图" id="zanshang" src="${internalUrls.zanshang}"/></a>\n            </div>\n          </div>\n          <div id="main">\n            <h1 style="margin-top: 0;">B站下载助手</h1>\n            <div class="settings">\n              <div class="setting-item">\n                <span class="label">清晰度：</span>\n                <span>请在页面中B站自己的播放器内切换清晰度</span>\n              </div>\n              <div class="setting-item">\n                <span class="label">下载模式：</span>\n                <label><input id="setting-download-mode-advanced" checked name="setting-download-mode" type="radio"/> 高级</label>\n                <label><input id="setting-download-mode-normal" name="setting-download-mode" type="radio"/> 兼容</label>\n                <p class="desc">高级模式支持自动重命名和合并下载，但会占用非常大的系统运行内存<br/>兼容模式直接使用浏览器的默认下载，资源占用很小，但不支持自动重命名和合并下载</p>\n                <p class="desc">建议系统运行内存小于16G的用户使用兼容模式，下载后可以点<a href="http://csser.top/bilibili/merge.html" target="_blank">这里</a>尝试手动合并</p>\n              </div>\n              <div class="setting-item" id="setting-advanced">\n                <span class="label">合并下载：</span>\n                <label><input id="setting-merge-on" checked name="setting-merge" type="radio"> 开</label>\n                <label><input id="setting-merge-off" name="setting-merge" type="radio"> 关</label>\n                <p class="desc">高级模式下载过程中请<strong style="color: red;">不要</strong>刷新或关闭页面，也<strong style="color: red;">不要</strong>切换分集和清晰度</p>\n              </div>\n            </div>\n            <h3 id="title">${a?"加载中"+r:u(t,n,e,i)}</h3>\n            <ul id="durls">\n              ${a?"":f(n,t,e)}\n            </ul>\n            <div class="beg">\n              <p>\n                如果这个工具确实帮到了您，烦请在Chrome商店给个五星好评，谢谢😊\n                <a class="btn" href="https://chrome.google.com/webstore/detail/bfcbfobhcjbkilcbehlnlchiinokiijp/reviews" target="_blank">去评价</a>\n              </p>\n            </div>\n          </div>\n          <div id="actions">\n            <button id="toggle" class="btn-large">${h()?"打开B站下载助手":"收起"}</button>\n          </div>\n        </div>\n      `,(e=>{const t=e.getElementById("setting-download-mode-advanced"),n=e.getElementById("setting-download-mode-normal"),i=e.getElementById("setting-merge-on"),a=e.getElementById("setting-merge-off"),o=e.getElementById("setting-advanced"),s=e.getElementById("durls"),r=e.getElementById("toggle"),l=e.getElementById("actions"),d=e.getElementById("content"),c=document.getElementById("bilibili-helper-host"),m=()=>{t.disabled=!0,n.disabled=!0,i.disabled=!0,a.disabled=!0},u=()=>{t.disabled=!1,n.disabled=!1,i.disabled=!1,a.disabled=!1};g()?(t.checked=!0,n.checked=!1,o.style.display="block"):(t.checked=!1,n.checked=!0,o.style.display="none"),p()?(i.checked=!0,a.checked=!1):(i.checked=!1,a.checked=!0);const f=()=>{e.buildDownloadLinks()};t.addEventListener("change",()=>{t.checked?(localStorage.bilibili_helper_download_mode="advanced",o.style.display="block"):(localStorage.bilibili_helper_download_mode="normal",o.style.display="none"),f()}),n.addEventListener("change",()=>{n.checked?(localStorage.bilibili_helper_download_mode="normal",o.style.display="none"):(localStorage.bilibili_helper_download_mode="advanced",o.style.display="block"),f()}),i.addEventListener("change",()=>{localStorage.bilibili_helper_merge_mode=i.checked?"on":"off",f()}),a.addEventListener("change",()=>{localStorage.bilibili_helper_merge_mode=a.checked?"off":"on",f()}),s.addEventListener("click",t=>{const n=t.target;if("a"===n.tagName.toLowerCase()&&"advanced"===n.getAttribute("mode")){if(t.preventDefault(),t.stopPropagation(),n.classList.contains("disabled"))return;let i=null;const a=n.getAttribute("title");"on"===n.getAttribute("merge")?(i=e.querySelector(`ul[durls="${n.getAttribute("durls")}"]`),m(),x(n,JSON.parse(decodeURIComponent(n.getAttribute("durls"))),a,i).then(u)):(i=e.querySelector(`span[durl="${n.getAttribute("durl")}"]`),m(),v(n,JSON.parse(decodeURIComponent(n.getAttribute("durl"))),a,i).then(u))}}),r.addEventListener("click",()=>{h()?(localStorage.bilibili_helper_show="show",d.classList.remove("hide"),r.innerHTML="收起",c.classList.remove("hide"),l.style.top="0",e.getElementById("notice-frame").contentWindow.postMessage({action:"getHeight"},"https://csser.top")):(localStorage.bilibili_helper_show="hide",d.classList.add("hide"),c.classList.add("hide"),r.innerHTML="打开B站下载助手",l.style.top="0")}),c.addEventListener("scroll",()=>{l.style.top=c.scrollTop+"px"})})(s),(e=>{const t=e.getElementById("notice-frame");t.onload=(()=>{t.contentWindow.postMessage({action:"getHeight"},"https://csser.top"),t.contentWindow.postMessage({action:"setVersion",version:{name:manifest.version,code:parseInt(manifest.version.replace(/\./g,""),10)}},"https://csser.top"),t.contentWindow.postMessage({action:"setTheme",theme:"null"},"https://csser.top")}),window.addEventListener("message",e=>{if("https://csser.top"===e.origin&&e.data&&"reportHeight"===e.data.action&&(t.style.height=e.data.height+10+"px"),"https://csser.top"===e.origin&&e.data&&"showBilibilihelperindooorsmanNoticeDialog"===e.data.action){const t=e.data.notices;t&&t.length>0&&t.forEach(e=>{})}}),t.src=`https://csser.top/bilibili/notice.html?t=${Date.now()}`,window.addEventListener("resize",()=>{t.contentWindow.postMessage({action:"getHeight"},"https://csser.top")})})(s)),s.buildDownloadLinks=(()=>{s.getElementById("durls").innerHTML=f(n,t,e)})},y=(e,t)=>{const n=new Blob([e],{type:"application/octet-stream"}),i=document.createElement("a");i.setAttribute("href",URL.createObjectURL(n)),i.setAttribute("download",t),i.setAttribute("style","position:absolute;top:-9999px;"),document.body.appendChild(i);const a=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});i.dispatchEvent(a),setTimeout(()=>{document.body.removeChild(i)},1e3)},w=(e,t,n)=>{let i=null;return fetch(e).then(e=>{const a=e.headers.get("content-length"),o=t||parseInt(a,10);let s=0;return i=setInterval(()=>{n(s,o)},1e3),new Response(new ReadableStream({start(t){const n=e.body.getReader(),i=()=>{n.read().then(({done:e,value:n})=>{e?t.close():(s+=n.byteLength,t.enqueue(n),i())}).catch(e=>{t.error(e)})};i()}}))}).then(e=>e.blob()).finally(()=>{i&&clearInterval(i)})},v=(e,{url:t,size:n},i,a)=>(e.classList.add("disabled"),w(t,n,(e,t)=>{const n=Math.ceil(e/t*100);a.innerHTML=` 正在下载 - ${e}/${t} - ${n}%`}).then(e=>{a.innerHTML=" 已下载完成";const n=new URL(t).pathname.toLowerCase().match(/\.[a-z0-9]+?$/)[0];y(e,i+n)}).finally(()=>{e.classList.remove("disabled")})),x=(e,t,n,i)=>{if(1===t.length)return v(e,t[0],n,i);e.classList.add("disabled");const a=t.map(({url:e,size:t},n)=>{const a=document.createElement("li");return a.innerHTML=`分段${n+1} (${m(t)}) 正在下载`,i.appendChild(a),w(e,t,(e,i)=>{const o=Math.ceil(e/i*100);a.innerHTML=`分段${n+1} (${m(t)}) 正在下载 - ${e}/${i} - ${o}%`}).then(e=>(a.innerHTML=`分段${n+1} (${m(t)}) 已下载完成，等待合并`,e))});return Promise.all(a).then(async e=>{const t=await o.mergeBlobs(Array.from(e));y(t,n+".flv"),i.innerHTML="已完成"}).finally(()=>{e.classList.remove("disabled")})},_=async()=>{if(!e())return;b({loading:!0});const i=await(()=>fetch(window.location.href,r).then(e=>e.text()).then(e=>{const t=e.match(/<script>window.__INITIAL_STATE__=(.+?)<\/script>/);return t&&t[1]?JSON.parse(t[1].replace(";(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());","")):{code:-2,message:"获取视频信息失败，可以尝试清除浏览器cookies和缓存后重试，如多次重试仍然报错，请通过邮箱或QQ群反馈给我，谢谢"}}).catch(()=>l()))();if(i.code)return b(i);let a=localStorage.bilibili_player_settings&&+JSON.parse(localStorage.bilibili_player_settings).setting_config.defquality||112;if(t()){const e=i.videoData.aid;let t,n,o=i.videoData.cid;if(i.videoData.pages.length>1){const e=location.search.match(/p=(\d+)/);let a=i.videoData.pages[0];e&&e[1]&&(a=i.videoData.pages.find(t=>""+t.page==""+e[1])),t=a.page,n=a.part,o=a.cid}const{code:s,durls:c,qualityDescription:g,message:p}=await((e,t,n=112)=>{return fetch(`//api.bilibili.com/x/player/playurl?cid=${t}&avid=${e}&otype=json&qn=${n}`,r).then(e=>e.json()).then(e=>0!==e.code?d(e):d(e.data)).catch(()=>l())})(e,o,a);if(0===s){let e=`[${g}] ${i.videoData.title}`;t&&n&&(e=`[${g}] ${i.videoData.title}_P${t}_${n}`),b({code:s,title:e,durls:c,message:p})}else b({code:s,message:p})}if(n()){const e=i.epList;let t=-1===i.epId?e[e.length-1].ep_id:i.epId,n=e.find(e=>t===e.ep_id);const o=await s(".episode-item.on"),c=await s(".ep-item.cursor");if(o||c){const i=o||c,a=i.parentElement;let r=Array.from(a.querySelectorAll("li")).findIndex(e=>e===i);const l=await s("#eplist_module .ep-list-progress");l&&(r=+l.textContent.match(/(\d+)\/\d+/)[1]-1),n=e[r],t=n.ep_id||n.id}const{code:g,durls:p,qualityDescription:h,message:m}=await((e,t=112)=>{return fetch(`//api.bilibili.com/pgc/player/web/playurl/?ep_id=${e}&qn=${t}&bsource=`,r).then(e=>e.json()).then(e=>0!==e.code?d(e):d(e.result)).catch(()=>l())})(t,a);if(0===g){const e=`[${h}] ${i.mediaInfo.title}_${n.index||n.title}_${n.index_title||n.longTitle}`;b({code:g,title:e,durls:p,message:m})}else b({code:g,message:m})}};_();let $=""+window.location.href,L=""+localStorage.bilibili_player_settings;setInterval(()=>{const e=window.location.href,t=localStorage.bilibili_player_settings;if($!==e&&($=e,_()),L!==t)try{if(JSON.parse(t).setting_config.defquality===JSON.parse(L).setting_config.defquality)return;L=t,_()}catch(e){}},1e3)})();</script></head>
<body>
<div align="center">
<table width="100%" border="0">
<tbody><tr valign="top">
<td align="left" width="25%">
  <span class="tiny"><a href="http://www.cse.unsw.edu.au/~cs3311">COMP3311 19s1</a></span>
</td>
<td align="center" width="50%">
  <span class="heading">Exercises 07</span><br>
  <span class="subheading">Relational Design Theory</span>
</td>
<td align="right" width="25%">
  <span class="tiny"><a href="http://www.cse.unsw.edu.au/~cs3311">Database Systems</a></span>
</td>
</tr></tbody></table>
</div><p style="text-align:center;font-size:75%"><a href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php?view=qo">[Show with no answers]</a> &nbsp; <a href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php?view=all">[Show with all answers]</a>

<br>
</p><center>
<table width="80%" border="1" cellpadding="6"><tbody><tr>
<td style="font-size:75%">
<p>
<b>Notation:</b> in the relational schemas below,
primary key attributes are shown in &nbsp; <code><b>bold</b></code> &nbsp; font,
foreign key attributes are shown in &nbsp; <code><i>italic</i></code> &nbsp; font,
and primary key attributes that are also foreign keys are
shown in &nbsp; <code><b><i>bold italic</i></b></code> &nbsp; font.
</p>
Example:
<pre>   Student(<u>id</u>, name, <i>degreeCode</i>)
   Degree(<u>code</u>, name, requirements)
   Subject(<u>code</u>, name, syllabus)
   Marks(<i><u>studentId</u></i>, <i><u>subjectCode</u></i>, <u>session</u>, mark)
</pre>
<p>
In their respective relations, the student id, the degree code
and the subject code are primary keys.
In the Student relation, the degree code is a foreign key.
In the Marks relation, the three attributes student id, subject
code and session together form the primary key; the first two
(student id and subject code) are also foreign keys.
</p>
</td></tr></tbody></table>
</center>

<ol>

<li>
<p>
Functional dependencies.
</p>
<ol type="a">
<li><p>
What functional dependencies are implied if we know that a set of
attributes <i>X</i> is a candidate key for a relation <i>R</i>?
</p>
<p><small>[<a id="q1a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q1&#39;)">show answer</a>]</small></p>
<div id="q1" style="color:#000099;display:none">
<p>
<i>X</i> functionally determines all of the other attributes
(i.e. <i>X</i> → <i>R-X</i>)
</p></div>
</li><li><p>
What functional dependencies can we infer <em>do not hold</em>
by inspection of the following relation?
</p>
<center>
<table width="30%" border="1" cellpadding="3">
<tbody><tr align="center"> <td><b>A</b></td> <td><b>B</b></td> <td><b>C</b></td> </tr>
<tr align="center"> <td>a</td> <td>1</td> <td>x</td> </tr>
<tr align="center"> <td>b</td> <td>2</td> <td>y</td> </tr>
<tr align="center"> <td>c</td> <td>1</td> <td>z</td> </tr>
<tr align="center"> <td>d</td> <td>2</td> <td>x</td> </tr>
<tr align="center"> <td>a</td> <td>1</td> <td>y</td> </tr>
<tr align="center"> <td>b</td> <td>2</td> <td>z</td> </tr>
</tbody></table>
</center>
<p><small>[<a id="q2a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q2&#39;)">show answer</a>]</small></p>
<div id="q2" style="color:#000099;display:none">
<p>
The tuples (a,1,x) and (a,1,y) ensure that
<i>A → C</i>
and
<i>B → C</i>
and
<i>AB → C</i>
do not hold.
<br>
The tuples (a,1,x) and (d,2,x) ensure that
<i>C → B</i>
and
<i>C → A</i>
do not hold.
<br>
The tuples (a,1,x) and (c,1,z) ensure that
<i>B → A</i>
and
<i>B → C</i>
do not hold.
<br>
Note that <i>C → A</i>
is not disproved by (a,1,x) and (a,1,y) or (b,2,y) and (b,2,z).
For other combinations of <i>ABC</i> there is only one instance
in the relation and so we cannot infer anything about dependency.
</p>
</div>
</li><li>
<p>
Suppose that we have a relation schema <i>R(A,B,C)</i> representing
a relationship between two entity sets <i>E</i> and <i>F</i>
with keys <i>A</i> and <i>B</i> respectively, and suppose that
<i>R</i> has (at least) the functional dependencies
<i>A → B</i> and
<i>B → A</i>.
Explain what this tells us about
the relationship between <i>E</i> and <i>F</i>.
</p>
<p><small>[<a id="q3a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q3&#39;)">show answer</a>]</small></p>
<div id="q3" style="color:#000099;display:none">
<p>
The <i>A → B</i> tells us
that every <i>A</i> value in <i>R</i> has exactly one corresponding
<i>B</i> value, and similarly
<i>B → A</i>
tells us that every <i>B</i> value has exactly one corresponding
<i>A</i> value.
In other words, the relationship must be 1:1.
</p>
</div>
</li></ol>

</li><li>
<p>
Consider the relation <i>R(A,B,C,D,E,F,G)</i> and the
set of functional dependencies
<i>F = { 
A → B,
BC → F,
BD → EG,
AD → C,
D → F,
BEG → FA
}
</i>
compute the following:
</p><p>
</p><ol type="a">
<li> <p><i>A<sup>+</sup></i></p>
<p><small>[<a id="q4a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q4&#39;)">show answer</a>]</small></p>
<div id="q4" style="color:#000099;display:none">
Derivation of A<sup>+</sup> ...
<br> given {A}
... using A → B gives {A,B}
... no further attributes can be added
<br> =&gt;  A<sup>+</sup> = {A,B}
<p></p>
</div>
</li><li> <p><i>ACEG<sup>+</sup></i></p>
<p><small>[<a id="q5a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q5&#39;)">show answer</a>]</small></p>
<div id="q5" style="color:#000099;display:none">
<p>
Derivation of ACEG<sup>+</sup>
<br> given {A,C,E,G}
... using A → B gives {A,B,C,E,G}
... using BC → F gives {A,B,C,E,F,G}
... no more
<br> ACEG<sup>+</sup> = {A,B,C,E,F,G}
</p>
</div>
</li><li> <p><i>BD<sup>+</sup></i></p>
<p><small>[<a id="q6a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q6&#39;)">show answer</a>]</small></p>
<div id="q6" style="color:#000099;display:none">
<p>
Derivation of BD<sup>+</sup>
<br> given {B,D}
... using BD → EG gives {B,D,E,G}
... using  BEG → FA gives {A,B,D,E,F,G}
... using AD → C gives {A,B,C,D,E,F,G}
... no more
<br> BD<sup>+</sup> = {A,B,C,D,E,F,G}
</p>
</div>
</li></ol>

</li><li>
<p>
Consider the relation <i>R(A,B,C,D,E)</i> and the set
set of functional dependencies
<i>F = { 
A → B,
BC → E,
ED → A
}
</i>
</p>
<ol type="a">
<li> <p>List all of the candidate keys for <i>R</i>.</p>
<p><small>[<a id="q7a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q7&#39;)">show answer</a>]</small></p>
<div id="q7" style="color:#000099;display:none">
<p>
A candidate key is any set <i>X</i>, such that <i>X<sup>+</sup> = R</i>
and there is no <i>Y</i> subset of <i>X</i> such that <i>Y<sup>+</sup> = R</i>.
</p>
<p>
In this case, the candidate keys are &nbsp; <i>CDE</i>, &nbsp; <i>ACD</i>,
&nbsp; <i>BCD</i>.
</p>
</div>
</li><li> <p>Is <i>R</i> in third normal form (3NF)?</p>
<p><small>[<a id="q8a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q8&#39;)">show answer</a>]</small></p>
<div id="q8" style="color:#000099;display:none">
<p>
Yes, because the right hand sides of all dependencies (i.e. <i>B</i>,
<i>E</i>, <i>A</i>) are parts of keys.
</p>
</div>
</li><li> <p>Is <i>R</i> in Boyce-Codd normal form (BCNF)?</p>
<p><small>[<a id="q9a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q9&#39;)">show answer</a>]</small></p>
<div id="q9" style="color:#000099;display:none">
<p>
No, because none of the left hand sides (i.e. <i>A</i>, <i>BC</i>, <i>ED</i>)
contains a key.
</p>
</div>
</li></ol>

</li><li>
<p>
Consider a relation <i>R(A,B,C,D)</i>.
For each of the following sets of functional dependencies,
assuming that those are the only dependencies that hold for
<i>R</i>, do the following:
</p>
<ol type="a">
<li> <p>List all of the candidate keys for <i>R</i>.</p>
</li><li> <p>Show whether <i>R</i> is in Boyce-Codd normal form (BCNF)?</p>
</li><li> <p>Show whether <i>R</i> is in third normal form (3NF)?</p>
</li></ol>
<p>
</p><ol type="i">
<li>
<p><i>
C → D, &nbsp;
C → A, &nbsp;
B → C
</i></p>
<p><small>[<a id="q10a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q10&#39;)">show answer</a>]</small></p>
<div id="q10" style="color:#000099;display:none">
<ol type="a">
<li> Candidate keys: &nbsp; <i>B</i>
</li><li> Not BCNF ... e.g. in <i>C → A</i>, <i>C</i> does not contain a key
</li><li> Not 3NF ... e.g. in <i>C → A</i>, <i>C</i> does not contain a key, <i>A</i> is not part of a key
</li></ol><br>
</div>
</li><li>
<i>
B → C, &nbsp;
D → A
</i>
<p><small>[<a id="q11a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q11&#39;)">show answer</a>]</small></p>
<div id="q11" style="color:#000099;display:none">
<ol type="a">
<li> Candidate keys: &nbsp; <i>BD</i>
</li><li> Not 3NF ... neither right hand side is part of a key
</li><li> Not BCNF ... neither left hand side contains a key
</li></ol><br>
</div>
</li><li>
<i>
ABC → D, &nbsp;
D → A
</i>
<p><small>[<a id="q12a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q12&#39;)">show answer</a>]</small></p>
<div id="q12" style="color:#000099;display:none">
<ol type="a">
<li> Candidate keys: &nbsp; <i>ABC</i> &nbsp; <i>BCD</i>
</li><li> 3NF ... <i>ABC → D</i> is ok, and even <i>D → A</i> is ok,
because <i>A</i> is a single attribute from the key
</li><li> Not BCNF ... e.g. in <i>D → A</i>, <i>D</i> does not contain a key
</li></ol><br>
</div>
</li><li>
<i>
A → B, &nbsp;
BC → D, &nbsp;
A → C
</i>
<p><small>[<a id="q13a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q13&#39;)">show answer</a>]</small></p>
<div id="q13" style="color:#000099;display:none">
<ol type="a">
<li> Candidate keys: &nbsp; <i>A</i>
</li><li> Not 3NF ... e.g. in <i>A → C</i>, <i>C</i> is not part of a key
</li><li> Not BCNF ... e.g. in <i>BC → D</i>, <i>BC</i> does not contain a key
</li></ol><br>
</div>
</li><li>
<i>
AB → C, &nbsp;
AB → D, &nbsp;
C → A, &nbsp;
D → B
</i>
<p><small>[<a id="q14a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q14&#39;)">show answer</a>]</small></p>
<div id="q14" style="color:#000099;display:none">
<ol type="a">
<li> Candidate keys: &nbsp; <i>AB</i> &nbsp; <i>BC</i> &nbsp; <i>CD</i> &nbsp; <i>AD</i>
</li><li> 3NF ... for <i>AB</i> case, first two fd's are ok,
and the others are also ok because the RHS is a single attribute from the key
</li><li> Not BCNF ... e.g. in <i>C → A</i>, <i>C</i> does not contain a key
</li></ol><br>
</div>
</li><li>
<i>
A → BCD
</i>
<p><small>[<a id="q15a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q15&#39;)">show answer</a>]</small></p>
<div id="q15" style="color:#000099;display:none">
<ol type="a">
<li> Candidate keys: &nbsp; <i>A</i>
</li><li> 3NF ... all left hand sides are superkeys
</li><li> BCNF ... all left hand sides are superkeys
</li></ol><br>
</div>
</li></ol>

</li><li>
<p>
Specify the non-trivial functional dependencies for each of
the relations in the following Teams-Players-Fans schema
and then show whether the overall schema is in BCNF.
</p>
<pre>Team(<u>name</u>, <i>captain</i>)
Player(<u>name</u>, <i>teamPlayedFor</i>)
Fan(<u>name</u>, address)
TeamColours(<u><i>teamName</i></u>, <u>colour</u>)
FavouriteColours(<u><i>fanName</i></u>, <i><u>colour</u></i>)
FavouritePlayers(<u><i>fanName</i></u>, <u><i>playerName</i></u>)
FavouriteTeams(<u><i>fanName</i></u>, <u><i>teamName</i></u>)
</pre>
<p><small>[<a id="q16a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q16&#39;)">show answer</a>]</small></p>
<div id="q16" style="color:#000099;display:none">
<p>
Functional dependencies:
</p>
<ul>
<li><tt>Team ...
	name → captain
    </tt>
</li><li><tt>Player ...
	name → teamPlayedFor
    </tt>
</li><li><tt>Fan ...
	name → address
    </tt>
</li><li><tt>TeamColours</tt> ... no non-trivial <i>fd</i>s
</li><li><tt>FavouriteColours</tt> ... no non-trivial <i>fd</i>s
</li><li><tt>FavouritePlayers</tt> ... no non-trivial <i>fd</i>s
</li><li><tt>FavouriteTeams</tt> ... no non-trivial <i>fd</i>s
</li></ul>
<p>
For each relation, every non-trivial <i>fd</i> has a left hand side
which is a super key ⇒ each
relation is in BCNF and the whole schema is in BCNF.
</p>
</div>

</li><li>
<p>
Specify the non-trivial functional dependencies for each of
the relations in the following Trucks-Shipments-Stores schema
and then show whether the overall schema is in BCNF.
</p>
<pre>Warehouse(<u>warehouse#</u>, address)
Source(<i><u>trip</u></i>, <i><u>warehouse</u></i>)
Trip(<u>trip#</u>, date, <i>truck</i>)
Truck(<u>truck#</u>, maxvol, maxwt)
Shipment(<u>shipment#</u>, volume, weight, <i>trip</i>, <i>store</i>)
Store(<u>store#</u>, storename, address)
</pre>
<p><small>[<a id="q17a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q17&#39;)">show answer</a>]</small></p>
<div id="q17" style="color:#000099;display:none">
<p>
Functional dependencies:
</p>
<ul>
<li><tt>Warehouse ...
	warehouse# → address
    </tt>
</li><li><tt>Source</tt> ... no non-trivial <i>fd</i>s
</li><li><tt>Trip ...
	trip# → date,truck
    </tt>
</li><li><tt>Truck ...
	truck# → maxvol,maxwt
    </tt>
</li><li><tt>Shipment ...
	truck# → volume,weight,trip,store
    </tt>
</li><li><tt>Store ...
	store# → storename,address
    </tt>
</li></ul>
<p>
For each relation, every non-trivial <i>fd</i> has a left hand side
which is a super key ⇒ each
relation is in BCNF and the whole schema is in BCNF.
</p>
<p>
This just goes to show that ER design generally leads to well-structured
relational designs.
</p>
</div>

</li><li>
<p>
For each of the sets of dependencies in question 4:
</p><p>
</p><ol type="i">
<li> <p>if <i>R</i> is not already in 3NF, decompose it into a set of 3NF relations</p>
</li><li> <p>if <i>R</i> is not already in BCNF, decompose it into a set of BCNF relations</p>
</li></ol>
<ol type="a">
<li><p>
<i>
C → D, &nbsp;
C → A, &nbsp;
B → C
</i>
</p>
<p><small>[<a id="q18a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q18&#39;)">show answer</a>]</small></p>
<div id="q18" style="color:#000099;display:none">
<p>
</p><ol type="i">
<p></p><li> application of the 3NF algorithm decomposes <i>R</i> into
	three relations based on the dependencies
	(<i>R<sub>1</sub>(CD)</i>, <i>R<sub>2</sub>(CA)</i>, <i>R<sub>3</sub>(BC)</i>);
	this decomposition leaves enough "connectivity" between the
	relations that no extra "candidate key" relation is needed
	to make them join-preserving
	(from now on, we denote a relation like <i>R<sub>1</sub>(CD)</i>
	 simply by <i>CD</i>)
<p></p></li><li> the above 3NF decomposition is also in BCNF
</li></ol>
</div>
</li><li><p>
<i>
B → C, &nbsp;
D → A
</i>
</p><p>
</p><p><small>[<a id="q19a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q19&#39;)">show answer</a>]</small></p>
<div id="q19" style="color:#000099;display:none">
<ol type="i">
<p></p><li> application of the 3NF algorithm decomposes <i>R</i> into
	<i>BC, AD</i> (using the dependencies), but also requires
	the addition of a "linking" relation <i>BD</i> containing
	the candidate key
<p></p></li><li> this is the same decomposition that would be reached by
	following the BCNF algorithm, although it would proceed
	by first producing <i>AD, BCD</i> and then decomposing
	<i>BCD</i> further into <i>BC, BD</i>
</li></ol>
</div>
</li><li><p>
<i>
ABC → D, &nbsp;
D → A
</i>
</p>
<p><small>[<a id="q20a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q20&#39;)">show answer</a>]</small></p>
<div id="q20" style="color:#000099;display:none">
<ol type="i">
<p></p><li> <i>R</i> is already in 3NF
<p></p></li><li> applying the BCNF algorithm means decomposition to "fix"
	the violation caused by
	<i>D → A</i>
	giving <i>AD, BCD</i>
	(note that this does not preserve the dependency
	<i>ABC → D</i>,
	and, in fact, it is not possible to find a BCNF decomposition
	which does preserve it)
</li></ol>
</div>
</li><li><p>
<i>
A → B, &nbsp;
BC → D, &nbsp;
A → C
</i>
</p>
<p><small>[<a id="q21a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q21&#39;)">show answer</a>]</small></p>
<div id="q21" style="color:#000099;display:none">
<ol type="i">
<p></p><li> the standard algorithm produces <i>AB, BCD, AC</i>, which contains
	enough connectivity to not require a "linking" relation
<p></p></li><li> <i>BC → D</i> violates BCNF
	because <i>BC</i> does not contain a key, so we split <i>R</i>
	into <i>BCD, ABC</i>, and this is now BCNF
</li></ol>
</div>
</li><li><p>
<i>
AB → C, &nbsp;
AB → D, &nbsp;
C → A, &nbsp;
D → B
</i>
</p>
<p><small>[<a id="q22a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q22&#39;)">show answer</a>]</small></p>
<div id="q22" style="color:#000099;display:none">
<ol type="i">
<p></p><li> <i>R</i> is already in 3NF
<p></p></li><li> applying the standard BCNF decomposition algorithm requires us
	to "fix" the BCNF violations caused by 
	<i>C → A</i> and
	<i>D → B</i>; this could
	be achieved by decomposing <i>R</i> into <i>AC</i> and <i>BCD</i>,
	but this does not preserve the other dependencies; to achieve
	dependency preservation requires the following decomposition:
	<i>AC, BD, CD, ABC, ABD</i> <small>(but the methods for doing
	this were not covered in lectures)</small>
</li></ol>
</div>
</li><li><p>
<i>
A → BCD
</i>
</p>
<p><small>[<a id="q23a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q23&#39;)">show answer</a>]</small></p>
<div id="q23" style="color:#000099;display:none">
<ol type="i">
<p></p><li> <i>R</i> is already in 3NF
<p></p></li><li> <i>R</i> is already in BCNF
</li></ol>
</div>
</li></ol>

</li><li>
<p>
Consider (yet another) banking application that contains information
about accounts, branches and customers.
Each account is held at a specific branch, but a customer may hold more
than one account and an account may have more than one associated
customer.
</p>
<p>
Consider an unnormalised relation containing all of the attributes that
are relevant to this application:
</p>
<ul>
<li> <i>acct#</i> - unique account indentifier
</li><li> <i>branch#</i> - unique branch identifier
</li><li> <i>tfn</i> - unique customer identifier (<b>t</b>ax <b>f</b>ile <b>n</b>umber)
</li><li> <i>kind</i> - type of account (savings, cheque, ...)
</li><li> <i>balance</i> - amount of money in account
</li><li> <i>city</i> - city where branch is located
</li><li> <i>name</i> - customer's name
</li></ul>
<p>
i.e. consider the relation <i>R(acct#, branch#, tfn, kind, balance, city, name)</i>
</p>
<p>
Based on the above description:
</p><ol type="a">
<li> <p>Devise a suitable set of functional dependencies among these attributes.</p>
<p><small>[<a id="q24a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q24&#39;)">show answer</a>]</small></p>
<div id="q24" style="color:#000099;display:none">
<p>  <i>acct# → kind, balance, branch#</i>
<br> <i>branch# → city</i>
<br> <i>tfn → name</i>
</p><p>
These all come from the semantics of the problem (e.g. each account has
exactly one type and balance, and is held at a specific branch).
</p>
</div>
</li><li> <p>Using these functional dependencies, decompose <i>R</i> into a set of BCNF relations.</p>
<p><small>[<a id="q25a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q25&#39;)">show answer</a>]</small></p>
<div id="q25" style="color:#000099;display:none">
<p>
In this case, the 3NF decomposition from applying the above three <i>fd</i>s
produces a BCNF decomposition as well. This is the simplest and most natural
decomposition of the problem.
</p>
<pre>Account(<u>acct#</u>, kind, balance, <i>branch</i>)
Branch(<u>branch#</u>, city)
Customer(<u>tfn</u>, name)
CustAcc(<u><i>customer</i></u>, <u><i>account</i></u>)
</pre>
<p>
The first three relations come directly from the dependencies;
the last relation comes from the final check for a relation with a
candidate key for <i>R</i> in the 3NF algorithm.
</p>
</div>
</li><li> <p>State whether the new relations are also in 3NF.</p>
<p><small>[<a id="q26a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q26&#39;)">show answer</a>]</small></p>
<div id="q26" style="color:#000099;display:none">
<p>
Since we produced the new relations using the 3NF decomposition method,
then they must be in 3NF.
</p>
</div>
</li></ol>

</li><li>
<p>
Consider a schema representing projects within a company, containing
the following information:
</p><p>
</p><ul>
<li> <i>pNum</i> - project's unique identifying number
</li><li> <i>pName</i> - name of project
</li><li> <i>eNum</i> - employee's unique identifying number
</li><li> <i>eName</i> - name of employee
</li><li> <i>jobClass</i> - type of job that employee has on this project
</li><li> <i>payRate</i> - hourly rate, dependent on the kind of job being done
</li><li> <i>hours</i> - total hours worked in this job by this employee
</li></ul>
<p>
This schema started out life as a large spreadsheet and now the
company wants to put it into a database system.
</p>
<p>
As a spreadsheet, its schema is:
<i>R(pNum, pName, eNum, eName, jobClass, payRate, hours)</i>
</p>
<p>
Based on the above description:
</p><ol type="a">
<li> Devise a suitable set of functional dependencies among these attributes.
<p><small>[<a id="q27a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q27&#39;)">show answer</a>]</small></p>
<div id="q27" style="color:#000099;display:none">
<p>
<i>pNum → pName</i>
<br> <i>eNum → eName</i>
<br> <i>jobClass → payRate</i>
<br> <i>pNum,eNum → jobClass,payRate,hours</i>
</p><p>
The above implies that <i>pNum,eNum</i> is a key for this relation (these
attributes determine all of the others).
</p><p>
Based on semantics given in the descriptions <em>and</em> on some
further assumptions, such as:
</p><ul>
<li> one employee can work on several projects
</li><li> they may be doing a different job in each project
</li></ul>
<p>
</p></div>
</li><li> Using these functional dependencies, decompose <i>R</i> into a set
	of BCNF relations.
<p><small>[<a id="q28a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q28&#39;)">show answer</a>]</small></p>
<div id="q28" style="color:#000099;display:none">
<p>
Following the BCNF decomposition algorithm ...
</p>
<ul>
<li> <i>pNum → pName</i> is a dependency on part of the key <br>
to fix: decompose to <i>R1(pNum,eNum,eName,jobClass,payRate,hours)</i> and <i>R2(pNum,pName)</i>
</li><li> <i>eNum → eName</i> is a dependency on part of the key <br>
to fix: decompose to <i>R1(pNum,eNum,jobClass,payRate,hours)</i> and <i>R2(pNum,pName)</i> and <i>R3(eNum,eName)</i>
</li><li> <i>jobClass → payRate</i> is a dependency on a non-key attribute <br>
to fix: decompose to <i>R1(pNum,eNum,jobClass,hours)</i> and <i>R2(pNum,pName)</i> and <i>R3(eNum,eName)</i> and <i>R4(jobClass,payRate)</i>
</li></ul>
<p>
The relevant functional dependencies are now:
</p><p>  <i>pNum → pName</i>
<br> <i>eNum → eName</i>
<br> <i>jobClass → payRate</i>
<br> <i>pNum,eNum → jobClass,hours</i>
</p><p>
With these dependencies there are no violations of BCNF, so the schema is
now in BCNF, and we could rename the relations as:
</p>
<pre>Project(<u>pNum</u>, pName)
Employee(<u>eNum</u>, eName)
AwardRates(<u>jobClass</u>, payRate)
Assignment(<u><i>pNum</i></u>, <u><i>eNum</i></u>, <i>jobClass</i>, hours)
</pre>
<p>
</p></div>
</li><li> State whether the new relations are also in 3NF.
<p><small>[<a id="q29a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q29&#39;)">show answer</a>]</small></p>
<div id="q29" style="color:#000099;display:none">
<p>
The new schema is <em>not</em> in 3NF because we have lost the
dependency: <i>pNum,eNum → payRate</i>
</p>
</div>
</li></ol>

</li><li>
<p>
Real estate agents conduct visits to rental properties
</p><ul>
<li> need to record which property, who went, when, results
</li><li> each property is assigned a unique code (P#, e.g. PG4)
</li><li> each staff member has a staff number (S#, e.g. SG43)
</li><li> staff members use company cars to conduct visits
</li><li> a visit occurs at a specific time on a given day
</li><li> notes are made on the state of the property after each visit
</li></ul>
The company stores all of the associated data in a spreadsheet.
<p>
Describe any functional dependencies that exist in this data.
The table of sample data below below may give some ideas:
</p><pre><b>P</b>#  | <b>W</b>hen        | <b>A</b>ddress    | <b>N</b>otes         | <b>S</b>#   | Na<b>m</b>e  | <b>C</b>arReg
----+-------------+------------+---------------+------+-------+-------
PG4 | 03/06 15:15 | 55 High St | Bathroom leak | SG44 | Rob   | ABK754
PG1 | 04/06 11:10 | 47 High St | All ok        | SG44 | Rob   | ABK754
PG4 | 03/07 12:30 | 55 High St | All ok        | SG43 | Dave  | ATS123
PG1 | 05/07 15:00 | 47 High St | Broken window | SG44 | Rob   | ABK754
PG2 | 13/07 12:00 | 12 High St | All ok        | SG42 | Peter | ATS123
PG1 | 10/08 09:00 | 47 High St | Window fixed  | SG42 | Peter | ATS123
PG3 | 11/08 14:00 | 99 High St | All ok        | SG41 | John  | AAA001
PG4 | 13/08 10:00 | 55 High St | All ok        | SG44 | Rob   | ABK754
PG3 | 05/09 11:15 | 99 High St | Bathroom leak | SG42 | Peter | ATS123
</pre>
<p>
State assumptions used in determining the functional dependencies.
</p>
<p><small>[<a id="q30a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q30&#39;)">show answer</a>]</small></p>
<div id="q30" style="color:#000099;display:none">
<ul>
<li> <i>P → A</i> ... the property code identifies a particular address
</li><li> <i>PW → N</i> ... notes are based on a particular visit to a property
</li><li> <i>PW → S</i> ... one staff member carries out each property visit
</li><li> <i>S → M</i> ... the staff number determines the staff member's name
</li><li> <i>S → C</i> ... each staff member uses a particular car (from table)
</li></ul>
<p>
Other dependencies are possible (e.g. <i>M → S</i>), but they appear
less plausible, given the semantics of the application.
</p>
</div>

</li><li>
<p>
Consider a company supplying temporary employees to hotels:
</p>
<ul>
<li> the company has contracts with different hotels
</li><li> it may have several contracts with a given hotel
</li><li> contracts are identified by a code (e.g. C12345)
</li><li> staff work at different hotels as needed
</li><li> staff have tax file #'s (TFN, e.g. T123)
</li><li> hotels have Aus business #'s (ABN, e.g. H234)
</li></ul>
Describe any functional dependencies that exist in this data.
The table of sample data below below may give some ideas:
<pre><b>C</b>ontract | <b>T</b>FN  | <b>N</b>ame       | H<b>r</b>s | <b>A</b>BN  | <b>H</b>otel
---------+------+------------+-----+------+-------------
C12345   | T311 | John Smith |  12 | H765 | Four Seasons
C18765   | T255 | Brad Green |  12 | H234 | Crown Plaza
C12345   | T311 | John Smith |  12 | H765 | Four Seasons
C12345   | T255 | Brad Green |  10 | H765 | Four Seasons
C14422   | T311 | John Smith |   6 | H222 | Sheraton
C14422   | T888 | Will Smith |   9 | H222 | Sheraton
C18477   | T123 | Clair Bell |  15 | H222 | Sheraton
</pre>
<p>
State assumptions used in determining the functional dependencies.
</p>
<p><small>[<a id="q31a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q31&#39;)">show answer</a>]</small></p>
<div id="q31" style="color:#000099;display:none">
<p>
Describe any functional dependencies that exist in this data.
</p>
<ul>
<li> <i>C → AH</i> ... a contract is with a particular hotel
</li><li> <i>A → H</i> ... each hotel has a unique ABN
</li><li> <i>T → N</i> ... each employee has a unique TFN
</li><li> <i>CT → R</i> ... each employee works specified hours on a contract
</li></ul>
<p>Other potential dependencies that <b>do not</b> apply:</p>
<ul>
<li> <i>C → T</i> ... because many employees can work on a contract
</li><li> <i>H → A</i> ... two different hotels may have the same name (e.g. Hilton)
</li></ul>
</div>

</li><li>
<p>
What functional dependencies exist in the following table:
</p>
<pre>  A  |  B  |  C  |  D
-----+-----+-----+-----
  1  |  a  |  6  |  x
  2  |  b  |  7  |  y
  3  |  c  |  7  |  z
  4  |  d  |  6  |  x
  5  |  a  |  6  |  y
  6  |  b  |  7  |  z
  7  |  c  |  7  |  x
  8  |  d  |  6  |  y
</pre>
<p>
How is this case different to the previous two?
</p>
<p><small>[<a id="q32a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q32&#39;)">show answer</a>]</small></p>
<div id="q32" style="color:#000099;display:none">
<p>
Since <i>A</i> has a different value in every tuple, it determines all
other attributes:
</p>
<p>
<i>A → B, A → C, A → D &nbsp; or &nbsp; A → BCD</i>
</p>
<p>
Also, <i>A</i> in combination with any other subset of attributes
determines all the others.
</p>
<p>
Similar reasoning could be applied to the combination <i>BCD</i>, since
it's unique over all tuples.
</p>
<p>
It also appears that <i>B → C</i>, but not <i>C → B</i>.
</p>
<p>
This case is different to the previous two because
there are no application semantics to draw on to determine reasonableness
of choice of FDs. All you can do is look for counter-examples
to eliminate certain potential dependencies.
Example: since <i>(C=6,B=a)</i> and <i>(C=6,B=d)</i> we can eliminate
<i>C → B</i>.
</p>
</div>

</li><li>
<p>
Compute a minimal cover for:
</p><p>
<i>
F &nbsp; = &nbsp; { B → A,&nbsp;
D → A,&nbsp;
AB → D
}
</i>
</p><p><small>[<a id="q33a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q33&#39;)">show answer</a>]</small></p>
<div id="q33" style="color:#000099;display:none">
<p>
Steps in converting to a minimal cover:
</p>
<ol>
<p></p><li> put FDs into canonical form:
<p>
<i>B → A, D → A, AB → D</i> is already in canonical form.
</p><p></p></li><li> eliminate redundant attributes:
<p>
The only possible redundant attributes are <i>A</i> or <i>B</i>
in <i>AB → D</i>.
</p><p>
We can prove that <i>A</i> is redundant as follows:
</p><p>
<i>B → A &nbsp; ⇒ &nbsp; BB → AB &nbsp; ⇒ &nbsp; B → AB</i>
</p><p>
<i> AB → D + B → AB &nbsp; ⇒ &nbsp; B → D</i>
</p><p>
Since we have <i>AB → D</i> and <i>B → D</i>, <i>A</i> is redundant.
</p><p></p></li><li> eliminate redundant dependencies:
<p>
The above elimination leaves:
<i>B → A, D → A, B → D</i>
</p><p>
But <i>D → A, B → D &nbsp; ⇒ &nbsp; B → A</i>
</p></li></ol>
<p>
So, the minimal cover is: <i>B → D, D → A</i>
</p>
</div>

</li><li>
<p>
Using the functional dependencies you produced in Q10,
convert the real-estate inspection spreadsheet (single
table), into a BCNF relational schema.
</p>
<p><small>[<a id="q34a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q34&#39;)">show answer</a>]</small></p>
<div id="q34" style="color:#000099;display:none">
<p>
FDs:
&nbsp; <i>P → A</i>,
&nbsp; <i>PW → NS</i>,
&nbsp; <i>S → MC</i>
&nbsp; <small>(reduced from the 5 FDs given above)</small>
</p>
<ul>
<li>
We start from a schema: <i>PAWNSMC</i>, which has key <i>PW</i>
	<small>(work it out from FDs)</small>.
</li><li>
The FD <i>S → MC</i> violates BCNF (FD with non-key on LHS).
</li><li>
To fix, we need to decompose into tables <i>PAWNS</i> and <i>SMC</i>.
</li><li>
Key for <i>PAWNS</i> is <i>PW</i>, and key for <i>SMC</i> is <i>S</i>.
</li><li>
Since all attributes in <i>SMC</i> are f-dependent on whole key, <i>SMC</i> is in BCNF.
</li><li>
The FD <i>P → A</i> violates BCNF in <i>PAWNS</i> (FD with partial key on LHS).
</li><li>
To fix, we need to decompose into tables <i>PWNS</i> and <i>PA</i>.
</li><li>
Key for <i>PAWNS</i> is <i>PW</i>, and key for <i>SMC</i> is <i>S</i>.
</li><li>
In both tables, all attributes are f-depdendent on whole key ⇒ BCNF.
</li><li>
Final schema (with keys boldened):
&nbsp; <i><b>PW</b>NS</i>,
&nbsp; <i><b>P</b>A</i>,
&nbsp; <i><b>S</b>MC</i>
</li></ul>
</div>

</li><li>
<p>
Consider the schema <i>R</i> and set of fds <i>F</i>
</p><p>
<i>R &nbsp;=&nbsp;  ABCDEFGH
<br>
F &nbsp;=&nbsp; { ABH → C,&nbsp; A → DE,&nbsp; BGH → F,&nbsp; F → ADH,&nbsp; BH → GE }
</i>
</p><p>
Produce a BCNF decomposition of <i>R</i>.
</p>
<p><small>[<a id="q35a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q35&#39;)">show answer</a>]</small></p>
<div id="q35" style="color:#000099;display:none">
<p>
This is just one of many possible decompositions.
Variations occur because of choice of candidate key (although
not in this example) and choice of non-BCNF FD to resolve at each step.
</p>
<ul>
<li>
We start from a schema: <i>ABCDEFGH</i>, with key <i>BH</i>
	<small>(work it out from FDs)</small>.
</li><li>
The FD <i>A → DE</i> violates BCNF (FD with non key on LHS).
</li><li>
To fix, we need to decompose into tables: <i>ADE</i> and <i>ABCFGH</i>.
</li><li>
FDs for <i>ADE</i> are <i>{ A → DE }</i>, therefore key is <i>A</i>, therefore BCNF.
</li><li>
FDs for <i>ABCFGH</i> are <i>{ ABH → C,&nbsp; BGH → F,&nbsp; F → AH,&nbsp; BH → G }</i>
</li><li>
Key for <i>ABCFGH</i> is <i>BH</i>, and FD <i>F → AH</i> violates BCNF (FD with non key on LHS).
</li><li>
To fix, we need to dcompose into tables: <i>AFH</i> and <i>BCFG</i>.
</li><li>
FDs for <i>ADE</i> are <i>{ F → AH }</i>, therefore key is <i>F</i>, therefore BCNF.
</li><li>
FDs for <i>BCFG</i> are <i>{ }</i>, so key is <i>BCFG</i> and table is BCNF.
</li><li>
Final schema (with keys boldened):
&nbsp; <i><b>A</b>DE</i>,
&nbsp; <i><b>F</b>AH</i>,
&nbsp; <i><b>BCFG</b></i>
</li></ul>
</div>

</li><li>
<p>
Using the functional dependencies you produced in Q10,
convert the real-estate inspection spreadsheet (single
table), into a 3NF relational schema.
</p><p><small>[<a id="q36a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q36&#39;)">show answer</a>]</small></p>
<div id="q36" style="color:#000099;display:none">
<p>
FDs:
&nbsp; <i>P → A</i>,
&nbsp; <i>PW → N</i>,
&nbsp; <i>PW → S</i>,
&nbsp; <i>S → M</i>,
&nbsp; <i>S → C</i>
</p><p>
This looks like a minimal cover; no redunant attributes; no redundant FDs.
</p><p>
3NF is constructed directly from the minimal cover,
after combinining dependencies with a common right hand side.
</p><p>
<i>F<sub>c</sub></i> &nbsp; =
&nbsp; <i>P → A</i>,
&nbsp; <i>PW → NS</i>,
&nbsp; <i>S → MC</i>
</p><p>
Gives the following tables (with table keys in <b>bold</b>):
</p><p>
<i><b>P</b>A</i> &nbsp; <i><b>PW</b>NS</i> &nbsp; <i><b>S</b>MC</i>
</p><p>
Since <i>PW</i> is a key for the whole schema, and since a table
contains this key, the 3NF decompostion is complete:
</p><p>
3NF &nbsp;=&nbsp; <i><b>P</b>A</i> &nbsp; <i><b>PW</b>NS</i> &nbsp; <i><b>S</b>MC</i>
</p></div>

</li><li>
<p>
Consider the schema <i>R</i> and set of fds <i>F</i>
</p>
<p>
<i>
R &nbsp;=&nbsp; ABCDEFGH
<br>
F &nbsp;=&nbsp; { ABH → C,&nbsp; A → D,&nbsp; C → E,&nbsp;
BGH → F,&nbsp; F → AD,&nbsp; E → F,&nbsp; BH → E }
<br>
F<sub>c</sub> &nbsp;=&nbsp; { BH → C,&nbsp; A → D,&nbsp; C → E,&nbsp;
F → A,&nbsp; E → F,&nbsp; BH → E }
</i>
</p><p>
Produce a 3NF decomposition of <i>R</i>.
</p><p><small>[<a id="q37a" href="https://cgi.cse.unsw.edu.au/~cs3311/19s1/exercises/07/index.php##" onclick="toggleVisible(&#39;q37&#39;)">show answer</a>]</small></p>
<div id="q37" style="color:#000099;display:none">
<p>
3NF is constructed directly from the minimal cover,
after combinining dependencies with a common right hand side where possible.
</p><p>
<i>F<sub>c</sub> &nbsp;=&nbsp; BH → C, &nbsp; A → D, &nbsp; C → E, &nbsp; F → A, &nbsp; E → F</i>
</p><p>
Gives the following tables (with table keys in <b>bold</b>):
</p><p>
<i><b>BH</b>C</i> &nbsp; <i><b>A</b>D</i> &nbsp;
<i><b>C</b>E</i> &nbsp; <i><b>F</b>A</i> &nbsp; <i><b>E</b>F</i>
</p><p>
A key for <i>R</i> is <i>BHG</i>; <i>G</i> must be included because it
appears in no function dependency.
</p><p>
Since no table contains the whole key for <i>R</i>,
we must add a table containing just the key, giving:
</p><p>
3NF = <i><b>BH</b>C</i> &nbsp; <i><b>A</b>D</i> &nbsp;
<i><b>C</b>E</i> &nbsp; <i><b>F</b>A</i> &nbsp; <i><b>E</b>F</i> &nbsp;
<i><b>BGH</b></i>
</p>
</div>
</li></ol>





</body></html>